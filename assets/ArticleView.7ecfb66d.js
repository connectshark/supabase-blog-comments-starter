import{u as D,a as I,b as L,r as m,w as M,c as N,d as U,e as q,o as s,f as i,g as t,h as e,t as c,F as p,i as h,v as E,j as b,k as F,l as H,m as T,n as j,p as z,q as $}from"./index.1d62df07.js";const G={key:0},J=e("p",{class:"text-center"},[e("i",{class:"bx bx-md bx-loader-alt bx-spin"})],-1),K=[J],O={key:1},P={class:"py-10 text-center text-2xl text-white bg-primary shadow-[0_0_0_100vmax_#7a6ae1] path"},Q={class:"py-4 break-words"},R=e("h3",{class:"text-center text-2xl text-white bg-primary"},"\u6587\u7AE0\u7DE8\u8F2F",-1),W={class:"py-3"},X=["disabled"],Y=e("label",{class:"inline-block ml-4",for:"Is_published"},"\u662F\u5426\u767C\u4F48",-1),Z=e("h3",{class:"text-center text-2xl text-white bg-primary"},"\u8A55\u8AD6",-1),ee={key:0,class:"text-center"},te=e("i",{class:"bx bx-md bx-loader-alt bx-spin"},null,-1),se=[te],ie={class:"leading-loose"},oe={class:"leading-loose"},ae={key:0,class:"text-right"},ne=["onClick"],le=["onSubmit"],de=e("h3",{class:"text-center text-2xl text-white bg-primary mb-5"},"\u65B0\u589E\u8A55\u8AD6",-1),re=["disabled"],ce={class:"text-right"},_e={key:0,type:"submit",class:"bg-primary text-white p-3 rounded-xl"},ue={key:0},pe=e("i",{class:"bx bx-loader bx-spin"},null,-1),he=[pe],be={key:1},ye={__name:"ArticleView",props:{id:String},setup(y){const _=y,o=D(),{results:n,loading:g}=I({selectString:"*",targetId:_.id}),{updateArticle:v,loading:k}=L({user_id:o.id}),l=m(!1);M(()=>{var u;l.value=(u=n.value)!=null&&u.is_published?n.value.is_published:!1});const f=async()=>{await v({is_published:l.value},{article_id:_.id})},d=m(""),{addComment:w,loading:x,deleteComment:C,comments:S}=N({article_id:_.id}),V=async()=>{await w({content:d.value,user_id:o.id}),d.value=""};return(u,r)=>{const A=U("router-link"),B=q("auto-animate");return s(),i(p,null,[t(g)?(s(),i("div",G,K)):(s(),i("article",O,[e("h1",P,c(t(n).title),1),e("p",Q,c(t(n).content),1)])),t(n).user_id===t(o).id?(s(),i(p,{key:2},[R,e("div",null,[e("p",W,[h(e("input",{"onUpdate:modelValue":r[0]||(r[0]=a=>l.value=a),disabled:t(k),onChange:f,type:"checkbox",id:"Is_published"},null,40,X),[[E,l.value]]),Y])])],64)):b("",!0),Z,h((s(),i("ul",null,[t(x)?(s(),i("li",ee,se)):b("",!0),(s(!0),i(p,null,F(t(S),a=>(s(),i("li",{key:a.user_id,class:"bg-gray-200 p-5 mb-5"},[e("p",ie,c(a.profiles.username),1),e("p",oe,c(a.content),1),t(o).id&&t(o).id===t(n).user_id||t(o).id&&t(o).id===a.user_id?(s(),i("p",ae,[e("button",{onClick:xe=>t(C)({id:a.id}),type:"button",class:"text-primary underline"},"\u522A\u9664",8,ne)])):b("",!0)]))),128))])),[[B]]),e("form",{onSubmit:z(V,["prevent"])},[de,h(e("textarea",{required:"",minlength:"1","onUpdate:modelValue":r[1]||(r[1]=a=>d.value=a),disabled:!t(o).id,class:"disabled:bg-gray-200 w-full resize-none rounded-lg border-2 border-gray-300 focus:border-primary appearance-none outline-none p-6",cols:"30",rows:"3"},null,8,re),[[H,d.value]]),e("div",ce,[t(o).id?(s(),i("button",_e,[t(x)?(s(),i("span",ue,he)):(s(),i("span",be,"\u9001\u51FA"))])):(s(),T(A,{key:1,class:"text-primary underline",to:"/login"},{default:j(()=>[$("\u767B\u5165\u767C\u8868\u8A55\u8AD6")]),_:1}))])],40,le)],64)}}};export{ye as default};
